{"files":[{"id":"7a0f9bef-3faa-441a-8d9d-0f6c77ffa7c3","name":"request to approval","type":"server_js","source":"function onSubmit(){\n  var formresponses \u003d FormApp.openById(\u0027/*form id here*/\u0027).getResponses();\n  var formresponse \u003d formresponses[formresponses.length-1];\n  var itemresponses \u003d formresponse.getItemResponses();\n  var formsheet \u003d SpreadsheetApp.openById(\u0027/*sheet id here*/\u0027).getSheets()[0];\n  var helpersheet \u003d SpreadsheetApp.openById(\u0027/*sheet id here*/\u0027).getSheets()[0];\n  var helpercontents \u003d helpersheet.getRange(1,1,helpersheet.getLastRow(),2).getValues();\n  var reqid \u003d \"req\"+(itemresponses[6].getResponse()).toLowerCase()+(formsheet.getLastRow()-1);\n  var lastrow\u003dformsheet.getLastRow()\n  var range\u003dformsheet.getRange(lastrow, \u002731\u0027).setValue(reqid)\n  for(i\u003d0;i\u003chelpercontents.length;i++){\n    if (itemresponses[6].getResponse() \u003d\u003d helpercontents[i][0]){\n    var emailid \u003d helpercontents[i][1];\n    Logger.log(emailid)   \n    var subject \u003d \"Network Account Creation (\"+reqid+\")\"\n    var body \u003d \"Hello, \\n User with the below listed details has requested for approval\"+\n    \"\\n\\n Name: \"+itemresponses[4].getResponse()+\" \"+itemresponses[5].getResponse()+\n    \"\\n Employee Number: \"+itemresponses[3].getResponse()+\n    \"\\n Department: \"+itemresponses[6].getResponse()+\n    \"\\n Designation: \"+itemresponses[7].getResponse()+\n    \"\\n Email ID: \"+itemresponses[12].getResponse()+\n    \"\\n Location: \"+itemresponses[0].getResponse()+\n    \"\\n Requested For: \"+itemresponses[1].getResponse()+\n    \"\\n Reason: \"+itemresponses[2].getResponse()+\n    \"\\n Reporting Head: \"+itemresponses[8].getResponse()+\n    \"\\n Network Devices: \"+itemresponses[11].getResponse()+\n    \"\\n Server Name: \"+itemresponses[13].getResponse()+\n    \"\\n Folder Name: \"+itemresponses[14].getResponse()+\n    \"\\n Access Rights: \"+itemresponses[15].getResponse()+\n    \"\\n Declaration: \"+itemresponses[16].getResponse()+\n    \"\\n\\n Please Accept/Reject the request from the below given link \\n\\n\"+\n    \"\\n\\n https://docs.google.com/a/lifecell.in/forms/d/e//*form id here*//viewform\"+\n    \"\\n\\n Best Regards, \\n Avinash Pasupulate\";\n      \n     //Must embedd form in mail with HTML\n    \n    GmailApp.sendEmail(emailid, subject, body);\n    }\n  }\n}\n"},{"id":"25cb4c2e-4466-4655-9c1e-39206d20da39","name":"dept approval to it","type":"server_js","source":"function onSubmit(){\n  var form \u003d FormApp.openById(\u0027/*form id here*/\u0027)\n  var formresponses \u003d form.getResponses();\n  var formresponse \u003d formresponses[formresponses.length-1];\n  var itemresponses \u003d formresponse.getItemResponses();\n  var formsheet \u003d SpreadsheetApp.openById(\u0027/*sheet id here*/\u0027).getSheets()[0];  \n  var headid \u003d formresponse.getRespondentEmail()  \n  for(i\u003d1;i\u003cformsheet.getLastRow()+1;i++){\n    Logger.log(row)\n    if(itemresponses[1].getResponse() \u003d\u003d \"Accepted\"){\n      if(itemresponses[0].getResponse() \u003d\u003d formsheet.getRange(i,31).getValue()){\n      formsheet.getRange(i, 20).setValue(\"Approved (\"+headid+\")\")\n          var row \u003d formsheet.getDataRange().getValues()[i-1];\n          var emailid \u003d \"email id here\";\n          var subject \u003d \"Network Account Creation (IT) (\"+row[30]+\")\"\n          var body \u003d \"Hello, \\n User with the below listed details has requested for approval\"+\n          \"\\n\\n Request ID: \"+row[30]+\n          \"\\n\\n Name: \"+row[6]+\" \"+row[7]+\n          \"\\n Employee Number: \"+row[5]+\n          \"\\n Department: \"+row[8]+\n          \"\\n Designation: \"+row[9]+\n          \"\\n Email ID: \"+row[1]+\n          \"\\n Location: \"+row[2]+\n          \"\\n Requested For: \"+row[3]+\n          \"\\n Reason: \"+row[4]+\n          \"\\n Reporting Head: \"+row[10]+\n          \"\\n Network Devices: \"+row[13]+\n          \"\\n Server Name: \"+row[15]+\n          \"\\n Folder Name: \"+row[16]+\n          \"\\n Access Rights: \"+row[17]+\n          \"\\n Declaration: \"+row[18]+\n          \"\\n\\n Approval: \"+(row[19])+\n          \"\\n\\n Please create the requested account and fill the details in the form (link) given below \"+\n          \"\\n\\n https://docs.google.com/a/lifecell.in/forms/d/e//*form id here*//viewform\"+\n          \"\\n\\n Best Regards, \\n Avinash Pasupulate\";\n      \n           //Must embedd form in mail with HTML\n          //var form \u003d   \u0027\u003chtml\u003e\u003cbody\u003e\u003c/body\u003e\u003c/html\u003e\u0027;//\n    \n        GmailApp.sendEmail(emailid, subject, body);\n      }\n    }else{\n          if(itemresponses[0].getResponse() \u003d\u003d formsheet.getRange(i,31).getValue()){\n          var row \u003d formsheet.getDataRange().getValues()[i-1];\n          formsheet.getRange(i, 20).setValue(\"Rejected (\"+headid+\")\")\n          var emailid \u003d row[1];\n          var subject \u003d \"Network Account Creation Rejected (\"+row[30]+\")\"\n          var body \u003d \"Dear User, \\n Your request for LifeCell account creation has been rejected,\"+\n          \"because \"+itemresponses[2].getResponse()+\n          \"\\n\\n Please contact your department head for further details\"+\n          \"\\n\\n Best Regards, \\n Avinash Pasupulate\";\n      \n           //Must embedd form in mail with HTML\n          //var form \u003d   \u0027\u003chtml\u003e\u003cbody\u003e\u003c/body\u003e\u003c/html\u003e\u0027;//\n    \n        GmailApp.sendEmail(emailid, subject, body);\n          }\n    }\n  }\n\n}\n"},{"id":"168da928-dc16-4fed-87ab-e04e1641b084","name":"creation to it head","type":"server_js","source":"function onSubmit(){\n  var form \u003d FormApp.openById(\u0027/*form id here*/\u0027)\n  var formresponses \u003d form.getResponses();\n  var formresponse \u003d formresponses[formresponses.length-1];\n  var itemresponses \u003d formresponse.getItemResponses();\n  var formsheet \u003d SpreadsheetApp.openById(\u0027/*sheet id here*/\u0027).getSheets()[0];  \n  var itid \u003d formresponse.getRespondentEmail()\n  \n  Logger.log(formresponses)\n  \n  //use iterations to reduce code\n  for(i\u003d1;i\u003cformsheet.getLastRow()+1;i++){\n      if(itemresponses[0].getResponse() \u003d\u003d formsheet.getRange(i,31).getValue()){        \n      formsheet.getRange(i, 21).setValue(itemresponses[1].getResponse())\n      formsheet.getRange(i, 22).setValue(itemresponses[2].getResponse())\n      formsheet.getRange(i, 23).setValue(itemresponses[3].getResponse())\n      formsheet.getRange(i, 24).setValue(itemresponses[4].getResponse())\n      formsheet.getRange(i, 25).setValue(itemresponses[5].getResponse())\n      formsheet.getRange(i, 26).setValue(itemresponses[6].getResponse())\n      formsheet.getRange(i, 27).setValue(itemresponses[7].getResponse())\n      formsheet.getRange(i, 28).setValue(itemresponses[8].getResponse())\n      formsheet.getRange(i, 29).setValue(itemresponses[9].getResponse()+\" (\"+itid+\")\")\n      \n          var row \u003d formsheet.getDataRange().getValues()[i-1];      \n          var emailid \u003d \"email id here\";\n          var subject \u003d \"Network Account Creation (IT) (\"+row[30]+\")\"\n          var body \u003d \"Hello, \\n User with the below listed details has requested for approval\"+\n          \"\\n\\n Request ID: \"+row[30]+\n          \"\\n\\n Name: \"+row[6]+\" \"+row[7]+\n          \"\\n Employee Number: \"+row[5]+\n          \"\\n Department: \"+row[8]+\n          \"\\n Designation: \"+row[9]+\n          \"\\n Email ID: \"+row[1]+\n          \"\\n Location: \"+row[2]+\n          \"\\n Requested For: \"+row[3]+\n          \"\\n Reason: \"+row[4]+\n          \"\\n Reporting Head: \"+row[10]+\n          \"\\n Network Devices: \"+row[13]+\n          \"\\n Server Name: \"+row[15]+\n          \"\\n Folder Name: \"+row[16]+\n          \"\\n Access Rights: \"+row[17]+\n          \"\\n Declaration: \"+row[18]+\n          \"\\n\\n Approval: \"+(row[19])+\n          \n          \"\\n\\n Login User ID: \"+row[20]+\n          \"\\n Login User group: \"+row[21]+\n          \"\\n User OU: \"+row[22]+\n          \"\\n Network Devices: \"+row[23]+\n          \"\\n LifeCell Email ID: \"+row[24]+\n          \"\\n Mail Box Size: \"+row[25]+  \n          \"\\n Web Filtering Group: \"+row[26]+\n          \"\\n Time Restriction: \"+row[27]+\n          \"\\n Executed By (IT): \"+row[28]+  \n            \n          \"\\n\\n Please approve the account creation in the form (link) given below \"+\n          \"\\n\\n https://docs.google.com/a/lifecell.in/forms/d/e//*form id*//viewform\"+\n          \"\\n\\n Best Regards, \\n Avinash Pasupulate\";\n      \n           //Must embedd form in mail with HTML\n          //var form \u003d   \u0027\u003chtml\u003e\u003cbody\u003e\u003c/body\u003e\u003c/html\u003e\u0027;//\n    \n        GmailApp.sendEmail(emailid, subject, body);\n      }\n  }   \n      \n}\n"},{"id":"13893a2d-cf1e-46e3-8520-9511f0d2c2b9","name":"head to end user","type":"server_js","source":"function onSubmit(){\n  var form \u003d FormApp.openById(\u0027/*form id here*/\u0027)\n  var formresponses \u003d form.getResponses();\n  var formresponse \u003d formresponses[formresponses.length-1];\n  var itemresponses \u003d formresponse.getItemResponses();\n  var formsheet \u003d SpreadsheetApp.openById(\u0027/*sheet id here*/\u0027).getSheets()[0];  \n  var headid \u003d formresponse.getRespondentEmail()  \n  \n  for(i\u003d1;i\u003cformsheet.getLastRow()+1;i++){\n    if(itemresponses[1].getResponse() \u003d\u003d \"Accepted\"){\n      if(itemresponses[0].getResponse() \u003d\u003d formsheet.getRange(i,31).getValue()){\n      formsheet.getRange(i, 30).setValue(\"Approved (\"+headid+\")\")\n      var row \u003d formsheet.getDataRange().getValues()[i-1];      \n          var emailid \u003d row[1];\n          var subject \u003d \"Network Account Creation Complete (\"+row[30]+\")\"\n          var body \u003d \"Dear User, \\n Your LifeCell account has been created, please find the details below,\"+\n          \"\\n\\n Request ID: \"+row[30]+\n          \"\\n\\n Name: \"+row[6]+\" \"+row[7]+\n          \"\\n Employee Number: \"+row[5]+\n          \"\\n Department: \"+row[8]+\n          \"\\n Designation: \"+row[9]+\n          \"\\n Location: \"+row[2]+\n          \"\\n LifeCell Domain Login:\"+row[20]+  \n          \"\\n LifeCell Email: \"+row[24]+\n          \"\\n\\n Please contact \"+row[28]+\" from IT department for your password\"+\n          \"\\n\\n Best Regards, \\n Avinash Pasupulate\";\n      \n           //Must embedd form in mail with HTML\n          //var form \u003d   \u0027\u003chtml\u003e\u003cbody\u003e\u003c/body\u003e\u003c/html\u003e\u0027;//\n    \n        GmailApp.sendEmail(emailid, subject, body);\n      }\n    }else{\n          if(itemresponses[0].getResponse() \u003d\u003d formsheet.getRange(i,31).getValue()){\n          var row \u003d formsheet.getDataRange().getValues()[i-1];\n          formsheet.getRange(i, 20).setValue(\"Rejected (\"+headid+\")\")\n          var emailid \u003d row[1];\n          var subject \u003d \"Network Account Creation Rejected (\"+row[30]+\")\"\n          var body \u003d \"Dear User, \\n Your request for LifeCell account creation has been rejected,\"+\n          \"because \"+itemresponses[2].getResponse()+\n          \"\\n\\n Please contact \"+row[28]+\" from IT department for further details\"+\n          \"\\n\\n Best Regards, \\n Avinash Pasupulate\";\n      \n           //Must embedd form in mail with HTML\n          //var form \u003d   \u0027\u003chtml\u003e\u003cbody\u003e\u003c/body\u003e\u003c/html\u003e\u0027;//\n    \n        GmailApp.sendEmail(emailid, subject, body);\n          }\n    }\n  }\n\n}\n"}]}