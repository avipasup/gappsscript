{"files":[{"id":"8e1279aa-3833-4520-a650-5945f3a35342","name":"Code","type":"server_js","source":"//this script was compiled using google closure compiler to simplify the code (\u0026 faster execution), so is not easily understandable (http://closure-compiler.appspot.com/home)\nfunction onSubmit(){var b\u003dFormApp.openById(\"/*form id here*/\").getResponses(),c\u003db[b.length-1],a\u003dc.getItemResponses(),e\u003dSpreadsheetApp.openById(\"/*sheet id here*/\").getSheets()[0],d\u003dSpreadsheetApp.openById(\"/*sheet id here*/\").getSheets()[1],d\u003dd.getRange(1,1,d.getLastRow(),4).getValues();for(i\u003d0;i\u003cd.length-1;i++){if(a[2].getResponse()\u003d\u003dd[i][1])var f\u003dd[i][0];if(a[0].getResponse()\u003d\u003dd[i][2]){var g\u003dd[i][3],h\u003d\"Form Requisition mail from \"+\na[0].getResponse(),k\u003d\"Hello, \\n Can you please issue \"+a[3].getResponse()+\" copies of the \"+a[2].getResponse()+\" form for the \"+a[0].getResponse()+\" department \\n\\n Thank you,\\n \"+a[1].getResponse()+\"\\n\"+a[0].getResponse();MailApp.sendEmail(g,h,k)}}c\u003dUtilities.formatDate(c.getTimestamp(),\"GMT+05:30\",\"dd/MM/yyyy\u0027 \u0027HH:mm\");e.appendRow([b.length.toString(),c,f,a[2].getResponse(),a[3].getResponse(),a[0].getResponse(),a[1].getResponse()]);b\u003dSpreadsheetApp.openById(\"/*sheet id here*/\").getSheets()[2];\nb.appendRow([\"\\n\"]);b.appendRow([\"Form requisitions for \"+c]);for(i\u003d0;i\u003ca[3].getResponse();i++)e\u003df+\"-\"+c+\"-\"+i,b.appendRow([e,fileid(e)])}function fileid(b){b\u003dUtilities.computeDigest(Utilities.DigestAlgorithm.MD5,b);var c\u003d\"\";for(i\u003d0;i\u003cb.length;i++){var a\u003db[i];0\u003ea\u0026\u0026(a+\u003d256);1\u003d\u003da.toString(16).length\u0026\u0026(c+\u003d\"0\");c+\u003da.toString(16)}return c};"}]}