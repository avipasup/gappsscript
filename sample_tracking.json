{"files":[{"id":"618493e2-dd30-4f30-8e7d-dce14a3ae618","name":"fetchsampletracker","type":"server_js","source":"//this script fetches the status and details of the specified CRM/LAB ID on the dashboard \n\nfunction on_submit() {\n  var sampletracker \u003d SpreadsheetApp.openById(\u0027sheet id here\u0027).getSheets()[0];\n  var contents \u003d sampletracker.getRange(3, 1, sampletracker.getLastRow(), 27).getValues();\n  var dashboard \u003d SpreadsheetApp.openById(\u0027sheet id here\u0027).getSheets()[0];\n  var dashtable \u003d dashboard.getRange(\u0027Sheet1!G5:O1002\u0027);\n  var resp \u003d dashboard.getRange(10, 3, 3).getValues();\n  var crmno \u003d resp[0];\n  var labid \u003d resp[2];\n // Logger.log(contents)\n  //clear input cells, use after program runs \n//  \n//  \n//  //compare input with sample tracker sheet\n//  //var samplerange \u003d sampletracker.\n  for (i\u003d0;i\u003ccontents.length;i++){\n    if (((crmno\u003d\u003dcontents[i][1])\u0026\u0026(crmno!\u003d\"\"))||((labid\u003d\u003dcontents[i][0])\u0026\u0026(labid!\u003d\"\"))){\n        dashboard.getRange(6,7).setValue(contents[i][0]) \n        dashboard.getRange(6,8).setValue(contents[i][6]) \n        dashboard.getRange(6,9).setValue(contents[i][2]) \n        dashboard.getRange(6,10).setValue(contents[i][1]) \n        dashboard.getRange(6,11).setValue(contents[i][7]) \n        dashboard.getRange(6,12).setValue(contents[i][19])\n        dashboard.getRange(6,13).setValue(contents[i][16])\n        dashboard.getRange(6,14).setValue(contents[i][18]) \n        dashboard.getRange(6,15).setValue(contents[i][4]+\" - \"+contents[i][5]) //Remarks\n\n    }\n//    else if ((crmno!\u003dcontents[i][1])||((labid!\u003dcontents[i][0])\u0026\u0026(labid!\u003d\"\"))){\n//      Logger.log(contents[i][1])\n//      dashboard.getRange(6,7).setValue(\"CRM/LAB ID Not Found\")\n//    }\n    dashboard.getRange(10, 3, 6).clearContent();\n  }\n}\n"},{"id":"4d2db89a-5c77-4549-80a9-0cc1aae217ec","name":"puttotracker","type":"server_js","source":"//This script updates the sample tracker sheet with entries made by the user in the sample status updater.\n\nfunction clear_range() {\n  var updater \u003d SpreadsheetApp.openById(\u0027sheet id here\u0027).getSheets()[0];\n  updater.getRange(5, 2, 50,8).clearContent()\n}\n\nfunction on_edit() {\n  var updatersheet \u003d SpreadsheetApp.getActiveSheet()\n  var range \u003d updatersheet.getRange(\"A1:H54\")\n  updatersheet.setActiveRange(range.offset(updatersheet.getLastRow(),5,1,1))\n}\n\nfunction on_submit() {\n  var sampletracker \u003d SpreadsheetApp.openById(\u0027sheet id here\u0027).getSheets()[0];\n  var contents \u003d sampletracker.getRange(3, 1, sampletracker.getLastRow(), 27).getValues();\n  var updater \u003d SpreadsheetApp.openById(\u0027sheet id here\u0027).getSheets()[0];\n  var updatetable \u003d updater.getRange(\u0027Sheet1!F4:H54\u0027).getValues();\n  var resp \u003d updater.getRange(4, 2, 2).getValues();\n  var status \u003d resp[1];\n  if (status\u003d\u003d\"Culture Setup\"){\n    var statusloc \u003d 10\n  }else if(status\u003d\u003d\"Post Incubation\"){\n    var statusloc \u003d 12\n  }else if (status\u003d\u003d\"Processing End\"){\n    var statusloc \u003d 14\n  }else if (status\u003d\u003d\"Analyzing \u0026 Report Release\"){\n    var statusloc \u003d 16\n  }  \n  for (i\u003d0;i\u003cupdatetable.length;i++){\n    if (((updatetable[i][0]!\u003d\"NA\")||(updatetable[i][0]!\u003d\"\"))\u0026\u0026((updatetable[i][0].length\u003d\u003d\"10.0\")||(updatetable[i][0].length\u003d\u003d\"7.0\"))){\n      var labid \u003d updatetable[i][0].slice(2)\n     updater.getRange(4+i, 7).setValue(new Date())\n     for (k\u003d0;k\u003ccontents.length;k++){\n       if ((labid\u003d\u003dcontents[k][0])\u0026\u0026(labid!\u003d\"\")){\n         updater.getRange(4+i, 8).setValue(\"Yes\")\n         sampletracker.getRange(3+k, statusloc).setValue(updater.getRange(4+i, 7).getValue())\n         var test \u003d updater.getActiveCell().getA1Notation()\n         }//else if((labid!\u003dcontents[k][0])\u0026\u0026(labid!\u003d\"\")){updater.getRange(4+i, 8).setValue(\"No\")}\n     }       \n    }\n  }\n    //updater.getRange(5, 2, 1).clearContent()\n}"},{"id":"288d9425-4276-42ae-931e-8ecce8195793","name":"auto_dispatch_email","type":"server_js","source":"function dateformat(date){\n  var strdate \u003d new Date(date)\n var outdate \u003d Utilities.formatDate(strdate, \"GMT+5:30\", \"dd/MM/yyyy\")\n  return outdate\n}\nfunction weeklydispatch() {\n  var sampletracker \u003d SpreadsheetApp.openById(\u0027sheet id here\u0027).getSheets()[0];\n  var contents \u003d sampletracker.getRange(3, 1, sampletracker.getLastRow(), 27).getValues();\n  var today \u003d new Date()\n  var array\u003d[]\n  var oneweek \u003d new Date(today.getTime() + 1000*60*60*24*7)\n  var l\u003d0\n    for (i\u003d0;i\u003ccontents.length;i++){      \n      if (((contents[i][17]\u003d\u003d\"NA\")||(contents[i][17]\u003d\u003d\"\"))\u0026\u0026(oneweek\u003e\u003dcontents[i][16])\u0026\u0026(contents[i][16]\u003e\u003dtoday)\u0026\u0026(contents[i][3]!\u003d\"Rejected\")\u0026\u0026(contents[i][19]!\u003d\"Report Dispatched\")){\n          array[l]\u003d[]\n          for (k\u003d0;k\u003c\u003d1;k++){if (k\u003d\u003d0){array[l].push(contents[i][0])}else if(k\u003d\u003d1){array[l].push(dateformat(contents[i][16]))}}\n        l++\n    }\n  }\n  var emailid \u003d\"email here\"\n  var cc \u003d \"email id here\"\n  var subject \u003d \"Samples to be dispatched between \"+dateformat(today)+\" - \"+dateformat(oneweek)\n  var body \u003d \"Dear Team, \\n Please find the list of samples to be dispatched in the current week attached below, please veriyfy the data with the receipt register\"+\"\\n\\n\"\n  for (m\u003d0;m\u003carray.length;m++){body+\u003d\"\\n\"+array[m][0]+\"  -  \"+array[m][1]}\n  GmailApp.sendEmail(emailid, subject,body,{\u0027cc\u0027:cc});\n}"},{"id":"3117bd5a-3ad8-4b6d-ad54-44d5db651be2","name":"processcompliancealert","type":"server_js","source":"function dateformat(date){\n  var strdate \u003d new Date(date)\n var outdate \u003d Utilities.formatDate(strdate, \"GMT+5:30\", \"dd/MM/yyyy\")\n  return outdate\n}\nfunction statusemail() {\n  var sampletracker \u003d SpreadsheetApp.openById(\u0027sheet id here\u0027).getSheets()[0];\n  var contents \u003d sampletracker.getRange(3, 1, sampletracker.getLastRow(), 27).getValues();\n  var today \u003d new Date()\n  var ysdy \u003d dateformat(new Date(today.getTime() - 1000*60*60*24*2))\n  var cc\u003d0; var ccd \u003d 0; var pi\u003d0; var pid\u003d0; var pp\u003d0; var ppd\u003d0; var ar\u003d0; var ard\u003d0\n    for (i\u003d0;i\u003ccontents.length;i++){      \n      if (dateformat(contents[i][8])\u003d\u003dysdy){\n        cc++\n          if(((contents[i][8])\u003c(contents[i][9]))||((contents[i][9])\u003d\u003d\"\")){\n            ccd++\n          }\n      }\n      if (dateformat(contents[i][10])\u003d\u003dysdy){\n        pi++\n          if(((contents[i][10])\u003c(contents[i][11]))||((contents[i][11])\u003d\u003d\"\")){\n            pid++\n          }\n      }\n      if (dateformat(contents[i][12])\u003d\u003dysdy){\n        pp++\n          if(((contents[i][12])\u003c(contents[i][13]))||((contents[i][13])\u003d\u003d\"\")){\n            ppd++\n          }\n      }\n       if (dateformat(contents[i][14])\u003d\u003dysdy){\n        ar++\n          if(((contents[i][14])\u003c(contents[i][15]))||((contents[i][15])\u003d\u003d\"\")){\n            ard++\n          }\n      }\n    }\n    var ccdev \u003d  ((100-(ccd*100)/cc).toFixed(2))+\"%\" \n    var pidev \u003d  ((100-(pid*100)/pi).toFixed(2))+\"%\" \n    var ppdev \u003d  ((100-(ppd*100)/pp).toFixed(2))+\"%\" \n    var ardev \u003d  ((100-(ard*100)/ar).toFixed(2))+\"%\" \n    var array\u003d[[\"Culture Setup \",ccdev],[\"Post Incubation \",pidev],[\"Post Processing \",ppdev],[\"Analysis \u0026 Reporting \",ardev]]\n  var emailid \u003d\"email id here\"\n  var cc \u003d \"email id here\"\n  var subject \u003d \"% of process compliance on \"+ysdy\n  var body \u003d \"Dear Team, \\n Please find the % of process compliance on \"+ysdy+\"\\n\\n\"\n  for (m\u003d0;m\u003carray.length;m++){body+\u003d\"\\n\"+array[m][0]+\"  -  \"+array[m][1]}\n  GmailApp.sendEmail(emailid, subject,body);\n}"},{"id":"4dc754f7-da44-42c6-bf04-e988f4406e71","name":"pendingupdates","type":"server_js","source":"function dateformat(date){\n  var strdate \u003d new Date(date)\n  var outdate \u003d Utilities.formatDate(strdate, \"GMT+5:30\", \"dd/MM/yyyy\")\n  return outdate\n}\nfunction pending() {\n  var sampletracker \u003d SpreadsheetApp.openById(\u0027/*SheetId here*/\u0027).getSheets()[0];\n  var contents \u003d sampletracker.getRange(3, 1, sampletracker.getLastRow(), 27).getValues();\n  var today \u003d new Date()\n  var ysdy \u003d new Date(today.getTime() - 1000*60*60*24*1)\n  var array\u003d[]\n  var l\u003d0\n    for (i\u003d0;i\u003ccontents.length;i++){      \n      if (((contents[i][17]\u003d\u003d\"NA\")||(contents[i][17]\u003d\u003d\"\"))\u0026\u0026(ysdy\u003econtents[i][16])\u0026\u0026(contents[i][3]!\u003d\"Rejected\")\u0026\u0026(contents[i][19]!\u003d\"Report Dispatched\")\u0026\u0026(contents[i][0]!\u003d\u0027\u0027)){\n          array[l]\u003d[]\n          for (k\u003d0;k\u003c\u003d2;k++){if (k\u003d\u003d0){array[l].push(contents[i][0])}else if(k\u003d\u003d1){array[l].push(dateformat(contents[i][16]))}else if(k\u003d\u003d2){array[l].push(contents[i][5])}}\n        l++\n    }\n  }\n//    Logger.log(array)\n  var emailid \u003d\"/*mail id here*/\"\n  var cc \u003d \"/*mail id here*/\"\n  var subject \u003d \"KT Pending/Tracker Not Updated Samples \"+dateformat(ysdy)\n  var body \u003d \"Dear Team, \\n Please find the list of samples which pending for dispatch or have not yet been updated on tracker attached below,\\n please veriyfy the data with the dispatch status \u0026 update the sample tracker if necessary\"+\"\\n\\n\"\n  for (m\u003d0;m\u003carray.length;m++){body+\u003d\"\\n\"+array[m][0]+\"  -  \"+array[m][1]+\"  -  \"+array[m][2]}\n  GmailApp.sendEmail(emailid, subject,body,{\u0027cc\u0027:cc});\n}"}]}